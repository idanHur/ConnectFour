@page
@model Server.Pages.Players.MainViewModel

@{
    Layout = "_Layout";
}

<div class="container mt-3">
    <h1>Player Data Viewer</h1>

    <div class="form-group">
        <label for="selectData">Select Data</label>
        <select class="form-control" id="selectData">
            <option value="">Select Data</option>
            <option value="AllPlayers">All Players</option>
            <option value="PlayersLastGameSorted">Sort Players By Last Game</option>
            <option value="AllGames">All Games</option>
            <option value="PlayerGameCounts">Player Game Counts</option>
            <option value="PlayersSortedByGameCount">Players Sorted By Game Count</option>
        </select>
    </div>
    
    <!-- Checkbox for sorting by name -->
    <div class="form-group mt-2" id="sortByNameCheck" style="display: none;">
        <input type="checkbox" id="sortByName" name="sortByName">
        <label for="sortByName">Sort By Name</label>
    </div>

    <div id="dataContainer" class="mt-3">
        <!-- The "AllPlayers" partial view will be loaded here dynamically -->
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            $('#selectData').on('change', function () {
                var value = $(this).val();

                // Show/hide the checkbox depending on the selected value
                if (value === 'AllPlayers') {
                    $('#sortByNameCheck').show();
                } else {
                    $('#sortByNameCheck').hide();
                    $('#sortByName').prop('checked', false); // Uncheck the checkbox
                }

                // Set the url based on the checkbox state and selected value
                var url = '/api/Players/';
                if ($('#sortByName').is(':checked')) {
                    url += 'SortByName';
                } else {
                    url += value;
                }
                $('#dataContainer').load(url);
            });

            // Event for the checkbox
            $('#sortByName').on('change', function () {
                var url = '/api/Players/';
                if ($(this).is(':checked')) {
                    url += 'SortByName';
                } else {
                    url += 'AllPlayers';
                }
                $('#dataContainer').load(url);
            });

            // Trigger the change event for the dropdown when the page loads
            $('#selectData').val('AllPlayers').trigger('change');
        });
    </script>
}
